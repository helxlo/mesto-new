(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{oi:()=>f,$t:()=>T,o3:()=>J,dd:()=>O,Zh:()=>j});var t={baseUrl:"https://nomoreparties.co/v1/wff-cohort-3",headers:{authorization:"5c7e4a88-915b-41bd-ae8c-c3716164a1c9","Content-Type":"application/json"}},n=function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))},o=function(){return fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers}).then(n)},r=function(){return fetch("".concat(t.baseUrl,"/cards"),{headers:t.headers}).then(n)};function c(e){e.classList.add("popup_opened"),document.addEventListener("keydown",a)}function u(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",a)}function a(e){"Escape"===e.key&&u(document.querySelector(".popup_opened"))}var i=document.querySelector(".popup_type_areyousure");function s(e){var o=document.querySelector("#element").content.querySelector(".element").cloneNode(!0),r=e.name,a=e.link,s=e.owner._id,l=e._id,p=e.likes,d="ebd0e184bdeb8eaf75866e3f";o.querySelector(".element__title").textContent=r;var _=o.querySelector(".element__pic");_.src=a,_.alt=r;var m=o.querySelector(".element__like"),v=p.some((function(e){return e._id===d}));v&&m.classList.add("element__like_active");var y=o.querySelector(".element__counter");m.addEventListener("click",(function(){return function(e,o,r){var c;o.classList.contains("element__like_active")?(c=e,fetch("".concat(t.baseUrl,"/cards/likes/").concat(c),{method:"DELETE",headers:t.headers}).then(n)).then((function(e){r.textContent=e.likes.length,o.classList.remove("element__like_active")})).catch(f):function(e){return fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:t.headers}).then(n)}(e).then((function(e){r.textContent=e.likes.length,o.classList.add("element__like_active")})).catch(f)}(l,m,y)})),y.textContent=p.length;var h=o.querySelector(".element__trash");return s===d&&(h.style.visibility="visible",h.addEventListener("click",(function(){!function(e,o){c(i),J.dataset.id=e,J.addEventListener("click",(function(r){r.preventDefault(),function(e){return fetch("".concat(t.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:t.headers}).then(n)}(e).then((function(){o.remove(),u(i)})).catch(f)}))}(l,o)}))),_.addEventListener("click",(function(){return function(e,t){c(O),T.src=e,j.textContent=t,T.alt=t}(a,r)})),o}var l=function(e,t,n){t.classList.remove(n.inputErrorClass);var o=e.querySelector(".".concat(t.id,"-error"));o.textContent="",o.classList.remove(n.errorClass)},p=function(e,t){e.classList.add(t.inactiveButtonClass),e.disabled=!0},d=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):p(t,n)};function _(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);n.forEach((function(r){l(e,r,t),d(n,o,t)}))}var f=function(e){console.log(e)},m=document.querySelectorAll(".popup"),v=document.querySelector(".profile__name"),y=document.querySelector(".profile__description"),h=document.querySelector(".profile__pic-zone"),b=document.querySelector(".profile__pic"),S=document.querySelector(".profile__editbutton"),q=document.querySelector(".popup_type_edit"),C=document.forms["edit-form"],E=C.querySelector(".popup__input_type_name"),L=C.querySelector(".popup__input_type_job"),k=document.querySelectorAll(".popup__savebutton"),g=document.querySelector(".elements"),x=document.querySelector(".profile__addbutton"),B=document.querySelector(".popup_type_add"),A=document.forms["add-form"],U=A.querySelector(".popup__input_type_title"),P=A.querySelector(".popup__input_type_link"),O=document.querySelector(".popup_type_fullscreen"),T=document.querySelector(".popup__fullscreen-pic"),j=document.querySelector(".popup__fullscreen-subtitle"),w=document.querySelector(".popup_type_avatar"),D=document.forms["avatar-form"],N=D.querySelector(".popup__input_type_avatar"),J=document.forms["delete-form"];function M(e){k.forEach((function(t){t.textContent=e?"Сохранение...":"Сохранить"}))}function z(){o().then((function(e){v.textContent=e.name,y.textContent=e.about,b.style.background="url(".concat(e.avatar,")")})).catch(f)}m.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&u(e),t.target.classList.contains("popup__closebutton")&&u(e)}))})),z(),Promise.all([z(),r()]),r().then((function(e){Array.from(e).forEach((function(e){var t=s(e);g.append(t)}))})).catch(f),D.addEventListener("submit",(function(e){e.preventDefault();var o,r=N.value;M(!0),(o=r,fetch("".concat(t.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:t.headers,body:JSON.stringify({avatar:o})}).then(n)).then((function(){b.style.background="url(".concat(r,")"),u(w),D.reset()})).catch(f).finally((function(){M(!1)}))})),S.addEventListener("click",(function(){E.value=v.textContent,L.value=y.textContent,_(C,{inputSelector:".popup__input",submitButtonSelector:".popup__savebutton",inactiveButtonClass:"popup__savebutton_disabled",inputErrorClass:"popup__input_type_error"}),c(q)})),C.addEventListener("submit",(function(e){var n,c;e.preventDefault(),M(!0),(n=E.value,c=L.value,Promise.all([o,r]).then((function(){fetch("".concat(t.baseUrl,"/users/me"),{method:"PATCH",headers:t.headers,body:JSON.stringify({name:n,about:c})})}))).then((function(){v.textContent=E.value,y.textContent=L.value,u(q)})).catch(f).finally((function(){M(!1)}))})),x.addEventListener("click",(function(){c(B),_(A,{inputSelector:".popup__input",submitButtonSelector:".popup__savebutton",inactiveButtonClass:"popup__savebutton_disabled",inputErrorClass:"popup__input_type_error"})})),A.addEventListener("submit",(function(e){e.preventDefault();var o,r,c=U.value,a=P.value;M(!0),(o=c,r=a,fetch("".concat(t.baseUrl,"/cards"),{method:"POST",headers:t.headers,body:JSON.stringify({name:o,link:r})}).then(n)).then((function(e){var t=s(e);g.prepend(t),u(B)})).catch(f).finally((function(){M(!1)})),A.reset()})),h.addEventListener("click",(function(){c(w),_(D,{inputSelector:".popup__input",submitButtonSelector:".popup__savebutton",inactiveButtonClass:"popup__savebutton_disabled",inputErrorClass:"popup__input_type_error"})})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);d(n,o,t),e.addEventListener("reset",(function(){p(o,t)})),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?l(e,t,n):function(e,t,n,o){t.classList.add(n.inputErrorClass);var r=e.querySelector(".".concat(t.id,"-error"));r.textContent=o,r.classList.add(n.errorClass)}(e,t,n,t.validationMessage)}(e,r,t),function(e){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity("")}(r),d(n,o,t)}))}))}(t,e)}))}({formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__savebutton",inactiveButtonClass:"popup__savebutton_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"})})();