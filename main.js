(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{$t:()=>w,o3:()=>B,dd:()=>P,Zh:()=>O});var t={baseUrl:"https://nomoreparties.co/v1/wff-cohort-3",headers:{authorization:"5c7e4a88-915b-41bd-ae8c-c3716164a1c9","Content-Type":"application/json"}},n=function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))},o=function(e){console.log(e)},r=function(){return fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers}).then(n).catch(o)},c=function(){return fetch("".concat(t.baseUrl,"/cards"),{headers:t.headers}).then(n).catch(o)};function a(e){e.classList.add("popup_opened"),document.addEventListener("keydown",i)}function u(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",i)}function i(e){"Escape"===e.key&&u(document.querySelector(".popup_opened"))}var s=document.querySelector(".popup_type_areyousure");function l(e,r,c,i,l){var d=document.querySelector("#element").content.querySelector(".element").cloneNode(!0);d.querySelector(".element__title").textContent=e;var p=d.querySelector(".element__pic");p.src=r,p.alt=e;var f=d.querySelector(".element__counter"),_=d.querySelector(".element__like"),m=l.some((function(e){return"ebd0e184bdeb8eaf75866e3f"===e._id}));m&&_.classList.add("element__like_active"),_.addEventListener("click",(function(){_.classList.contains("element__like_active")?function(e){return fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:t.headers}).then(n).catch(o)}(i).then((function(e){f.textContent=e.likes.length,_.classList.remove("element__like_active")})):function(e){return fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:t.headers}).then(n).catch(o)}(i).then((function(e){f.textContent=e.likes.length,_.classList.add("element__like_active")}))})),f.textContent=l.length;var v=d.querySelector(".element__trash");return"ebd0e184bdeb8eaf75866e3f"===c._id&&(v.style.visibility="visible",B.addEventListener("submit",(function(e){e.preventDefault(),function(e){fetch("".concat(t.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:t.headers}).then(n).catch(o)}(i),d.remove(i),u(s)}))),v.addEventListener("click",(function(){return a(s)})),p.addEventListener("click",(function(){a(P),w.src=r,O.textContent=e,w.alt=e})),d}var d=function(e,t){e.classList.add(t.inactiveButtonClass),e.disabled=!0},p=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):d(t,n)},f=document.querySelectorAll(".popup"),_=document.querySelector(".profile__name"),m=document.querySelector(".profile__description"),v=document.querySelector(".profile__pic-zone"),y=document.querySelector(".profile__pic"),h=document.querySelector(".profile__editbutton"),b=document.querySelector(".popup_type_edit"),S=document.forms["edit-form"],q=S.querySelector(".popup__input_type_name"),L=S.querySelector(".popup__input_type_job"),E=document.querySelectorAll(".popup__savebutton"),k=document.querySelector(".elements"),C=document.querySelector(".profile__addbutton"),x=document.querySelector(".popup_type_add"),g=document.forms["add-form"],U=g.querySelector(".popup__input_type_title"),A=g.querySelector(".popup__input_type_link"),P=document.querySelector(".popup_type_fullscreen"),w=document.querySelector(".popup__fullscreen-pic"),O=document.querySelector(".popup__fullscreen-subtitle"),T=document.querySelector(".popup_type_avatar"),j=document.forms["avatar-form"],D=j.querySelector(".popup__input_type_avatar"),B=document.forms["delete-form"];function N(e){E.forEach((function(t){t.textContent=e?"Сохранение...":"Сохранить"}))}f.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&u(e),t.target.classList.contains("popup__closebutton")&&u(e)}))})),r().then((function(e){_.textContent=e.name,m.textContent=e.about,y.style.background="url(".concat(e.avatar,")")})),c().then((function(e){Array.from(e).forEach((function(e){var t=l(e.name,e.link,e.owner,e._id,e.likes);k.append(t)}))})),j.addEventListener("submit",(function(e){e.preventDefault();var r,c=D.value;N(!0),(r=c,fetch("".concat(t.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:t.headers,body:JSON.stringify({avatar:r})}).then(n).catch(o)).then((function(){y.style.background="url(".concat(c,")"),u(T),j.reset()})).finally((function(){N(!1)}))})),h.addEventListener("click",(function(){q.value=_.textContent,L.value=m.textContent,a(b)})),S.addEventListener("submit",(function(e){var a,i;e.preventDefault(),N(!0),_.textContent=q.value,m.textContent=L.value,(a=q.value,i=L.value,Promise.all([r,c]).then((function(){fetch("".concat(t.baseUrl,"/users/me"),{method:"PATCH",headers:t.headers,body:JSON.stringify({name:a,about:i})})})).then(n).catch(o)).then((function(){u(b)})).finally((function(){N(!1)}))})),C.addEventListener("click",(function(){return a(x)})),g.addEventListener("submit",(function(e){e.preventDefault();var r,c,a=U.value,i=A.value;N(!0),(r=a,c=i,fetch("".concat(t.baseUrl,"/cards"),{method:"POST",headers:t.headers,body:JSON.stringify({name:r,link:c})}).then(n).catch(o)).then((function(e){var t=l(e.name,e.link,e.owner,e._id,e.likes);k.prepend(t)})).finally((function(){N(!1)})),u(x),g.reset()})),v.addEventListener("click",(function(){a(T)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);p(n,o,t),e.addEventListener("reset",(function(){d(o,t)})),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?function(e,t,n){t.classList.add(n.inputErrorClass);var o=e.querySelector(".".concat(t.id,"-error"));o.textContent=t.dataset.errorMessage,o.classList.add(n.errorClass)}(e,t,n):function(e,t,n){t.classList.remove(n.inputErrorClass);var o=e.querySelector(".".concat(t.id,"-error"));o.textContent="",o.classList.remove(n.errorClass)}(e,t,n)}(e,r,t),p(n,o,t)}))}))}(t,e)}))}({formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__savebutton",inactiveButtonClass:"popup__savebutton_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"})})();